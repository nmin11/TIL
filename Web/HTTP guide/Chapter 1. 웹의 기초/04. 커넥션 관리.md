- HTTP 명세는 HTTP 커넥션과 HTTP 메시지의 흐름에 대한 내용은 충분히 다루고 있지 않음
- HTTP 애플리케이션을 개발하고 있다면 HTTP 커넥션에 대해 잘 이해해야 함
- HTTP 커넥션 관리는 실험이나 시행착오를 통해서 많은 것을 배울 수 있는 마술 같은 기술

<br>

## 1. TCP 커넥션

- 전 세계 모든 HTTP 통신은 패킷 교환 네트워크 프로토콜들의 계층화된 집합인 TCP/IP를 통해 이루어짐
- 세계 어디서든 클라이언트 애플리케이션과 서버 애플리케이션은 TCP/IP 커넥션을 맺을 수 있음
- 일단 커넥션이 맺어지면 주고받는 메시지들은 손실되거나 손상되거나 순서가 뒤바뀌거나 하지 않고 안전하게 전달됨

(이미지 첨부 - TCP/IP 커넥션)

### 1.1 신뢰할 수 있는 데이터 전송 통로인 TCP

- HTTP 커넥션에서 몇몇 사용 규칙을 빼면 TCP 커넥션이나 다름 없음
- 신속 정확하게 데이터를 보내고자 한다면 TCP의 기초적인 내용을 알아야 함
- TCP는 HTTP에게 신뢰할 만한 통신 방식을 제공
- TCP 커넥션 상에서 byte들은 순서에 맞게 정확하게 전달됨

### 1.2 TCP 스트림은 세그먼트로 나뉘어 IP 패킷을 통해 전송된다

- TCP는 IP 패킷이라 불리는 작은 조각을 통해 데이터를 전송함

(이미지 첨부 - HTTP HTTPS 네트워크 프로토콜 스택)

- HTTP는 메시지를 전송할 때 연결되어 있는 TCP 커넥션을 통해서 메시지의 내용을 순서대로 보냄
- TCP는 세그먼트라는 단위로 스트림을 잘게 나누고, 세그먼트를 IP 패킷이라 불리는 봉투에 담아서 전달함
- 위 과정은 TCP/IP 소프트웨어에 의해 처리되며, 그 과정은 HTTP 프로그래머에게 보이지 않음
- 각 TCP 세그먼트는 하나의 IP 주소에서 다른 IP 주소로 IP 패킷에 담겨 전달되며 다음 요소들을 포함함
  - IP 패킷 헤더 (보통 20byte)
    - 발신지, 목적지 IP 주소, 크기, 기타 플래그를 가짐
  - TCP 세그먼트 헤더 (보통 20byte)
    - TCP 포트 번호, TCP 제어 플래그, 데이터 순서 무결성 검사를 위한 숫자 값
  - TCP 데이터 조각 (0 이상의 byte)

(이미지 첨부 - IP 패킷)
