- HTTP는 오직 출발지와 목적지를 고려하지만 미러링된 서버, 웹 프록시, 캐시를 거쳐야 하기 때문에 단순하지 않음
- 리다이렉션 기술 → HTTP 메시지의 최종 목적지를 결정하는 네트워크 도구, 기법, 프로토콜
- 리다이렉션 기술은 보통 메시지가 프록시, 캐시, 서버 팜의 특정 웹 서버 중 어디에서 끝났는지 판별하기 위해 사용
- 리다이렉션 기술은 클라이언트의 메시지를 명시적으로 요청하지 않은 곳으로 보낼 수 있음
- 이번 장에서 배울 키워드들
  - HTTP 리다이렉션
  - DNS 리다이렉션
  - 임의 캐스트 라우팅
  - 정책 라우팅
  - IP 맥 포워딩
  - IP 주소 포워딩
  - WCCP (웹 캐시 조직 프로토콜)
  - ICP (인터캐시 커뮤니케이션 프로토콜)
  - HTCP (하이퍼텍스트 캐싱 프로토콜)
  - NECP (네트워크 요소 제어 프로토콜)
  - CARP (캐시 배열 라우팅 프로토콜)
  - WPAD (웹 프록시 자동발견 프로토콜)

<br>

## 1. 왜 리다이렉트인가?

- HTTP 애플리케이션이 언제나 원하는 3가지
  - 신뢰할 수 있는 HTTP 트랜잭션 수행
  - 지연 최소화
  - 네트워크 대역폭 절약
- 이를 보장하기 위해 흔히 웹 컨텐츠는 여러 장소에 배포됨
  - 한 곳의 장애에도 대응 가능
  - 보다 가까운 리소스에 접근 가능
  - 네트워크 혼잡도 줄어듦
- 리다이렉션: 최적의 분산된 컨텐츠 탐색을 도와주는 기법의 집합
- 리다이렉션 구현에는 부하 균형 과제가 함께 딸려옴
  - 대부분의 리다이렉션 장치들은 몇 가지 방식의 부하 균형을 포함
  - 마찬가지로 부하 균형 또한 어떤 식으로든 부하를 공유하는 서버들 중 하나에 리다이렉션되어야 함

<br>

## 2. 리다이렉트 할 곳

- 서버, 프록시, 캐시, 게이트웨이는 모두 공통적으로 서버의 특성을 갖고 있음
  - 많은 리다이렉션 기법이 이들 모두에서 동작
- 그러나 특정 종류의 종단만을 위해 특별히 설계된 기법들이 따로 있음 (나중 배울 내용)
- 웹 서버는 IP별로 요청을 다룸
  - 요청을 분산한다는 것은 같은 URL에 대한 각 요청을 최적의 웹 서버로 보내겠다는 뜻
- 프록시는 프로토콜별로 요청을 다룸
  - 이상적으로 프록시 이웃의 모든 HTTP 트래픽은 프록시를 거쳐야 함 (통신 비용 절약)
  - 프록시로의 리다이렉트는 주 진입로의 트래픽을 지름길로 빨아들이는 것

<br>

## 3. 리다이렉션 프로토콜의 개요

- 리다이렉션의 목표: HTTP 메시지를 가용한 웹 서버로 가급적 빨리 보내는 것
  - 메시지가 오가는 라우팅 장치에 영향을 받게 됨
- 메시지를 리다이렉트하는 메커니즘들: 브라우저 설정, DNS, TCP/IP 라우팅, HTTP

|                메커니즘                 | 작동 방식                                                   | 재 라우팅 근거                                           | 제약사항                                                |
| :-------------------------------------: | :---------------------------------------------------------- | :------------------------------------------------------- | :------------------------------------------------------ |
|             HTTP 리다이렉션             | 첫 번째 웹 서버에서 리다이렉트를 선택하게 함                | 라운드 로빈 부하 균형, latency 최소화, 최단 거리 선정 등 | 모든 트랜잭션이 추가 리다이렉트를 포함할 수 있음        |
|             DNS 리다이렉션              | DNS 서버가 어떤 IP 주소를 사용할지 결정                     | 라운드 로빈 부하 균형, latency 최소화, 최단 거리 선정 등 | DNS 서버 설정 필요                                      |
|          임의 캐스트 어드레싱           | 여러 서버가 같은 IP 주소 사용                               | 라우터들은 내장된 최단거리 라우팅 기능 사용              | 라우터 설정 필요, 주소 충돌 위험                        |
|              IP MAC 포워딩              | 스위치, 라우터 등 네트워크 요소가 패킷의 목적지 주소를 읽음 | 대역폭 절약, QOS(Quality of Service) 개선                | 서버나 프록시는 반드시 한 홉 거리에 있을 것             |
|             IP 주소 포워딩              | 스위치가 패킷의 목적지 포트 평가                            | 대역폭 절약, QOS 개선                                    | 서버나 프록시가 클라이언트의 IP 주소를 잃어버릴 수 있음 |
|          명시적 브라우저 설정           | 웹 브라우저가 가까운 프록시에게 HTTP 메시지를 보내도록 설정 | 대역폭 절약, QOC 개선                                    | 브라우저 설정 능력에 의존                               |
|     PAC (Proxy Auto-Configuration)      | 웹 브라우저가 설정 서버로부터 PAC 파일 검색                 | 대역폭 절약, QOC 개선                                    | 브라우저가 설정 서버에 질의를 보낼 수 있을 것           |
| WPAD (Web Proxy Autodiscovery Protocol) | 웹 브라우저가 설정 서버에게 PAC 파일에 대한 URL 질의        | 설정 서버가 URL 결정                                     |                                                         |
| WCCP (Web Cache Coordination Protocol)  | 라우터가 패킷의 목적지 주소를 평가                          | 대역폭 절약, QOC 개선                                    | 브라우저가 반드시 WCCP를 지원해야 함                    |
|      ICP (Internet Cache Protocol)      | 프록시 캐시가 형제 캐시에게 요청 받는 컨텐츠에 대해 질의    | 캐시를 통해 원 서버보다 빠르게 얻어냄                    | 캐시 적중이 아닐 수도 있게 됨                           |
|   CARP (Cache Array Routing Protocol)   | 캐시 컨텐츠 분산                                            | 캐시를 통해 원 서버보다 빠르게 얻어냄                    | CARP 설정에 동의할 것                                   |
|   HTCP (Hyper Text Caching Protocol)    | 프록시 캐시가 형제 캐시에게 요청 받는 컨텐츠에 대해 질의    | 캐시를 통해 원 서버보다 빠르게 얻어냄                    |                                                         |
