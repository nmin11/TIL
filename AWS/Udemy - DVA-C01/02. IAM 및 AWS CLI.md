## IAM: Users & Groups

Identity and Access Management

- 글로벌 서비스: 사용자를 생성하고 그룹에 배치하기 때문
- Root account: 계정 생성시 기본으로 생성됨
  - 오직 계정을 생성할 때만 사용되어야 함
  - 절대 외부에 공유하지 말고, 대신 사용자를 생성해야 함
- Users: 하나의 사용자는 조직 내 한 사람에 해당
  - 필요하다면 유저들을 그룹으로 묶을 수 있음
- Groups: 오직 유저들만 포함할 수 있고, 그룹을 포함할 순 없음
  - 유저는 그룹에 속하지 않을 수도 있고, 다수의 그룹에 속할 수도 있음

<br>

### IAM: Permissions

- 유저와 그룹에게 JSON 문서를 통해 권한을 부여해줄 수 있음
- policies를 활용해서 사용자들의 권한을 정의
- AWS는 모든 사용자에게 모든 것을 허용하지 않음
  - 비용 발생 및 보안 문제를 야기할 수 있기 때문
  - 그러므로 AWS는 최소 권한 원칙을 사용함(least privilege principle)

<br>

### IAM Policies inheritance

- 정책을 그룹 레벨에 적용하면 그룹의 모든 구성원에게 적용됨
- 사용자에게 직접 연결하기 위한 inline 정책도 있음
  - 그룹에 속해 있든 속해 있지 않든 적용 가능

<br>

### IAM Policies Structure

```json
{
  "Version": "2012-10-17",
  "Id": "S3-Account-Permissions",
  "Statement": [
    {
      "Sid": "1",
      "Effect": "Allow",
      "Principal": {
        "AWS": ["arn:aws:iam::123456789012:root"]
      },
      "Action": ["s3:GetObject", "s3:PutObject"],
      "Resource": ["arn:aws:s3:::mybucket/*"]
    }
  ]
}
```

구성 요소

- Version
  - 정책 언어 버전
  - 보통 2012-10-17 버전을 사용함
- Id
  - 정책을 식별하는 Id (Optional)
- Statement
  - 하나 이상의 문장 (Required)
  - Sid: 문장 ID (문장의 식별자) (Optional)
  - Effect: 문장이 특정 API에 접근하는 걸 허용하는지 거부하는지 (Allow / Deny)
  - Principal: 정책이 적용될 사용자, 계정, 혹은 역할로 구성됨
  - Action: Effect에 기반해서 허용되거나 거부될 API 호출의 목록
  - Resource: 적용될 Action의 리소스 목록
  - Condition: Statement가 적용될 조건을 결정 (Optional)

⭐ 시험을 위해서는 Effect, Principal, Action, Resource에 대해 확실히 이해하고 있어야 함

<br>

### IAM 계정 보안

**Password Policy**

- Strong passwords: 강력한 비밀번호를 통한 계정 보안
- AWS에서는 다양한 옵션을 이용해서 비밀번호 정책을 생성할 수 있음
  - 비밀번호 최소 길이
  - 특정 유형의 문자 사용 요구(대소문자, 숫자, 특수문자 등)
- IAM 사용자들의 비밀번호 변경을 허용 또는 금지할 수 있음
- 일정 기간이 지나면 비밀번호를 만료시키고 새 비밀번호 설정을 요구할 수도 있음
- 비밀번호 re-use를 막아서 반드시 새로운 비밀번호로만 재설정하게 할 수 있음

**Multi Factor Authentication (MFA)**

- AWS에서 필수적으로 사용하게끔 권장됨
- Root 계정 뿐만 아니라 IAM 유저들도 MFA를 통해서 보호해야 함
- MFA는 내가 알고 있는 비밀번호와 내가 갖고 있는 보안 장치를 함께 사용하는 것

**MFA devices options in AWS**

※ 시험에 출제되는 내용이지만 간단함

- Virtual MFA device
  - Google Authenticator (phone only)
  - Authy (multi-device) ※ 컴퓨터와 휴대전화에서 같이 사용 가능
- Universal 2nd Factor (U2F) Security Key
  - YubiKey (AWS의 3rd party인 Yubico에서 제공하는 장치) ※ 하나의 물리적 키로 여러 계정을 한번에
- Hardware Key Fob MFA Device
  - Gemalto (AWS의 3rd party)
- Hardware Key Fob MFA Device for AWS GovCloud (US) ※ 미국 정부 클라우드를 사용하는 경우
  - SurePassID (AWS의 3rd party)
