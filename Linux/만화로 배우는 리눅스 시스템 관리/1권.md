## SSH : 다른 컴퓨터를 리모트로 조작하고 싶어

- SSH는 Secure Shell의 약어
- 다른 PC에 네트워크 경유로 로그인해서 조작할 수 있게 함
- 통신 경로는 암호화
- 인터넷 경유라도 IP 주소만 알면 리모트 조작 가능
- 접속 명령어 예시 : `ssh user@192.168.11.5`
- X를 활용해서 리눅스 화면 표시 및 입력을 다룰 수도 있음
  - 명령어 예시 : `ssh -Y -C user@192.168.11.5` 이후 `nautilus`
  - `-Y`는 X 전송 지정, `-C`는 통신 내용 압축
  - X를 통해 다른 PC에서 동작하는 프로그램을 자기 PC 화면에 표시해서 조작 가능
  - 간단한 리모트 데스크톱 개념
- SSH 접속 끊기 명령어 : `exit`

※ rsh(Remote Shell) : 같은 원격 조작의 기능이지만 통신의 암호화가 없음

<br>

## sudo : 임시로 관리자 권한을 얻고 싶어

- 리눅스의 접근 권한 : 모든 파일이나 폴더에 누구 것인지, 누가 읽고 쓰는지에 대한 권한을 설정함
- 접근 권한은 파일 소유자가 아니면 바꿀 수 없지만 root는 예외
  - root는 관리자 권한을 가진 특별 사용자로, 파일 접근 권한 변경 및 파일 수정 등 모든 것이 가능함
  - 그러므로 root 암호는 철저하게 관리해야 하며, 우분투는 root 로그인을 막기도 함
- root는 미리 정한 특정 사용자에게 root와 같은 권한 부여 가능
- `sudo`를 사용하면 자신의 관리자 권한을 행사할 수 있음
- GUI에서도 `sudo`와 같은 기능 실행 가능
  - 예시 : `gksudo --sync nautilus`

※ 우분투에서 꼭 root로 로그인해야 한다면 `sudo -i` 또는 `sudo su`를 활용하면 됨

<br>

## grep : 다양한 문자열을 한 번에 검색하고 싶어

- global regular expression print
  - 파일 전체에서 정규 표현식과 일치하는 위치를 출력하라
- 파일 내용을 확인해서 찾는 문자열이 포함되었는지 조사
- 예시 : `grep -r "검색할 문자열" /home/docs/`
  - `-r` : 서브 폴더까지 검색하도록 지정
  - `/home/docs` : 찾을 파일이 있는 폴더 경로(검색 시작점)
- 검색 시 `발견된 파일 위치: 발견된 위치의 텍스트` 형태로 출력

※ `-i`를 사용해서 대소문자 구분 없이 검색할 수도 있음

<br>

## vim : 터미널에서도 대화형으로 파일을 편집하고 싶어

- 파일이 열렸으면 `i` 키로 수정하고 `esc` 키로 편집을 끝냄
- vim의 기본이 되는 vi는 일반적인 PC가 없을 때 키보드, 마우스 등이 없던 환경을 위해 만들어졌음
  - 그래서 하나의 키가 여러 역할을 하도록 설계되었던 것
  - 그러다보니 INSERT와 같은 모드가 생겨났음
- vim의 모드들
  - 노멀 모드 : 시작했을 때의 홈 화면
  - `i` : 끼워넣기 모드, 일반 에디터와 같은 조작 방법
  - `shift + r` : 치환 모드
  - `v` : 선택 모드
  - `/` : 검색 모드
  - `esc` : 어떤 모드에서도 처음 화면으로 돌아가게 해줌
  - 주로 사용하는 것은 노멀 모드와 끼워넣기 모드
- 끼워넣기 모드에서 편집이 끝나면 `esc` → `:wq` 로 저장
  - w : write (디스크에 쓰기)
  - q : quit (vim 종료)
- 검색 모드 사용법 `/문자열`
  - 사용 시 노멀 모드 상에서 찾은 곳으로 스크롤됨
  - 편집 후 다시 노멀 노드로 돌아왔으면 `n` 키를 눌러서 다음으로 찾은 위치 검색 가능
  - 반대 방향으로 다음 위치를 찾으려면 `shift + n`
  - 정규 표현식으로 찾을 수도 있음
    - 예시 : `/\v(CP949|EUC-KR)`
    - `\v`를 앞에 두고 정규표현식을 넣어야 함

※ https://vim.rtorr.com/lang/ko/ 사이트에서 더 많은 명령어 확인 가능

<br>

## yank : vim에서도 복사 & 붙이기 & 되돌리기를 하고 싶어

- vim에서 ctrl + c, ctrl + v 가 안 되는 이유
  - GUI 애플리케이션끼리는 복붙을 공통으로 연계하지만<br>콘솔 애플리케이션은 다른 방식으로 작동하기 때문
  - GNOME 단말(터미널)은 콘솔 애플리케이션을 데스크톱에서 보여주는 "창" 같은 것
  - 그러므로 단말에 하는 조작인지, 그 뒤의 콘솔 애플리케이션에 하는 조작인지를 구별해야 함
  - 간단하게 보면 마우스로도 조작이 가능하면 단말 자체 조작<br>키보드로만 할 수 있는 조작이라면 콘솔 애플리케이션 자체 조작
- 복사하기
  - 노멀 모드에서 복사 시작 위치에 커서를 두고 `v` 키 입력
  - 복사 끝 위치까지 화살표 키를 통해 커서 이동
  - `y` 키를 눌러서 클립보드에 텍스트 복사
    - yank : 끌어당기다
- 붙여넣기
  - 붙이고 싶은 위치로 커서 이동
  - `shift + p` 입력
    - paste : 붙이다
    - `1`, `0`, `shift + p` 와 같이 사용하면 10번 반복해서 붙여넣을 수도 있음
- 콘솔 환경에서의 ctrl + z 는 되돌리기가 아닌 **일시 정지**
  - 실행 중이던 애플리케이션을 백그라운드로 보내고 bash 창을 다시 띄움
  - `fg` 명령어로 다시 애플리케이션 창으로 돌아갈 수 있음
    - background에 있던 애플리케이션을 다시 foreground로 되돌린다는 뜻
- 되돌리기를 하고 싶다면 u 키 입력
  - 노멀 모드에서 해야 함
  - `1`, `0`, `u` 와 같이 사용하면 10번 되돌릴 수 있음
- 되돌리기를 되살리고 싶다면 `ctrl + r` 입력
  - r : redo
  - 마찬가지로 앞에 숫자를 넣어서 원하는 횟수만큼 되살릴 수 있음

<br>

## 가상 터미널 (tmux) : 갑작스러운 네트워크 끊김에서 복귀하고 싶어

- GNOME 단말이 데스크톱 환경에서 콘솔 환경을 들여다보는 창이라면<br>가상 단말은 콘솔 환경에서 GNOME 단말이 하는 것과 같은 걸 하는 애플리케이션
- 사실 가상 단말 쪽이 먼저 생기고 그 다음 GNOME 단말이 생겨난 것
- 가상 단말에도 여러 종류가 있는데, 여기서는 **tmux** 이용
  - `tmux` 명령어를 통해 사용 가능
  - 명령어를 찾지 못할 경우 `sudo apt-get install tmux` 명령을 통해 설치할 것
- 가상 단말은 SSH 접속이 끊기더라도 계속 동작하는 특징이 있음
- 그러므로 `tmux attach`를 실행하면 서버에 남아 있는 tmux 가상 단말에 재접속 가능
- tmux 자체 기능을 사용할 때는 `ctrl + b` 입력
  - `ctrl + b` → `d` : detach
  - `ctrl + b` → `c` : create
  - `ctrl + b` → `p` : previous
  - `ctrl + b` → `n` : next
- `ctrl + b`를 이용하는 이유는 이미 존재하는 다른 조작법과 겹치지 않기 위해서
- ctrl 키와 함께 사용하는 다른 조작법 예시
  - `ctrl + r` : 되살리기
  - `ctrl + c` : 프로세스 종료
  - `ctrl + z` : 프로세스 일시 정지
- tmux의 create, previous, next를 사용하면 새 탭을 열기도 하고 다른 탭으로 이동하기도 함
  - GNOME 단말 탭을 사용하면 그때마다 SSH 접속을 해야되므로 비효율적
  - 반면에 tmux를 사용하면 SSH 접속은 한번만 해도 되고, attach로 끊긴 작업도 접근 가능

※ 다른 가상 단말들

- screen
  - 오래 되었고 유명함
  - 설정을 변경하지 않으면 사용하기 불편
- byobu
  - 이름의 유래는 병풍
  - tmux나 screen을 확장해서 보다 편리하고 간단하게 사용 가능
  - 그러나 가상 단말을 통해 실행하는 다른 애플리케이션에 영향을 많이 끼침

<br>

## 화면 분할 (tmux) : 다른 화면도 보면서 작업하고 싶어

- 가로 분할 : `ctrl + b` → `"`
- 세로 분할 : `ctrl + b` → `%`
- 화면 포커스 이동 : `ctrl + b` → `←↓↑→`
- 분할 해제 : 명령어 `exit`
- 범위 선택 시작 : `ctrl + b` → `[`
- 범위 선택 종료 : `q` or `esc`
- 분할된 화면 크기 조절 : `ctrl + b` → `ctrl` 키를 누른 채로 `←↓↑→`

※ 범위 선택은 원래 복붙을 위한 기능이지만 스크롤을 위해서도 사용할 수 있음
