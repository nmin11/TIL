## 4 steps of software delivery

Build ⇒ Release ⇒ Deploy ⇒ Rollout

- 사실 딜리버리를 위해 정해진 업계 표준은 없지만 본 책에서는 이 4단계를 기본 구조로 잡고 설명
- package
  - 소프트웨어는 반드시 패키지로 **build** 되어야 함
  - 패키지는 반드시 불변이며 버전이 지정되어야 함
  - 패키지는 생성 후 반드시 **release** 되어야 함
- 릴리스 과정에서 릴리스 노트 및 변경 로그가 업데이트되어야 함
- 릴리스 후 패키지를 중앙식 리포지토리로 발행
- 발행된 릴리스는 테스트 환경이나 프로덕션 환경으로 **deploy** 되어야 함
- 배포된 소프트웨어는 install 되었을 뿐 상용화된 상태가 아님
- 상용화를 위해 **rollout**
- 롤아웃 후 사용자 피드백 수집, 버그 발견, 새로운 제품 요구사항 반영
  - 이를 바탕으로 다시 delivery 단계들 시작
- 각 딜리버리 단계들을 위한 일련의 권장 기법이 존재

## source control branching strategy

- release package: 버전 제어 시스템의 코드로부터 빌드
- trunk: 변경 이력을 가진 주 버전의 코드 베이스
- branch: 코드 수정을 위해 트렁크로부터 가지를 쳐서 나온 것
  - 개발자들이 브랜치에서 병렬적으로 작업하고 준비가 되면 트렁크로 변경사항 merge
- 다양한 브랜칭 전략마다 브랜치 유지 기간이나 릴리스 버전 등에 대한 나름의 정의가 있음

trunk-based

- 모든 개발자가 트렁크로부터 브랜치를 생성
- 브랜치는 작은 기능, 버그 수정, 업데이트 등을 위해 사용됨
- 개발자가 브랜치를 공유하지 않으며, 시간 단위가 아닌 일 단위의 신속한 merge가 많은 환경에 적합
- 자주 merge하는 방식을 CI(Continuous Integration)라고도 함
- 각 개발자들이 최신 버전의 코드로부터 벗어나 있는 시간이 줄어드니 위험도 줄일 수 있음
- 반면에 트렁크에 버그가 존재하면 모든 개발자의 개발 속도가 느려짐
  - 그래서 merge 이전에 자동화된 테스트 기능 필요
- 보통 트렁크는 항상 릴리스 가능한 상태를 유지하고, 릴리스도 자주 일어남

feature branch-based

- 기능 브랜치가 상당히 오래 유지되면서 여러 개발자가 함께 작업
- 각 기능 브랜치는 제품의 특정 기능과 관련됨
- 기능 브랜치가 outdated 되지 않도록 rebase를 수행해야 함
  - 기능 브랜치의 안정성도 rebase 수행 시점에 관리해야 함
- 릴리스 준비가 되면 기능 브랜치를 릴리스 브랜치로 가져옴
- 트렁크의 코드가 불안정해서 트렁크를 안정화시키면서 기능도 개발해야 할 때 사용하는 방법

⇒ service-oriented system 이라면 일반적으로 trunk-based 개발 전략을 채택!

**Gitflow**

- 2010년 빈센트 드리센이 소개한 가장 보편적인 기능 브랜치 전략!
- `develop` `hotfix` `release` 브랜치 사용
- develop: 기능 브랜치를 merge하고 rebase하는 주 브랜치
- release
  - 릴리스 준비가 되었을 때 develop 브랜치로부터 가지 치기
  - 릴리스 안정화 도중 개발 업무는 기능 브랜치에서 진행
  - 릴리스 안정화 이후 트렁크로 merge
- hotfix
  - 심각한 버그로 인해 트렁크가 불안정해졌을 때 통상적인 릴리스 절차 없이 즉시 수정
  - 버그 수정 후 hotfix 브랜치를 트렁크와 develop 브랜치 양쪽에 merge
